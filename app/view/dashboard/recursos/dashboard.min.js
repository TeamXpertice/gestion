function getMonthName(t){const e=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];return e[t-1]}document.addEventListener("DOMContentLoaded",function(){fetch("/gestion/app/controller/DashboardController.php?action=getData").then(t=>t.json()).then(t=>{const e=t.comprasPorMes,o=t.ventasPorMes,a=[],n=[],r=[];let s=0,c=0;e.forEach(function(t){const e=t.mes,o=t.anio;a.push(getMonthName(e)+" "+o),n.push(t.total_compras),s+=Number(t.total_compras)}),o.forEach(function(t){r.push(t.total_ventas),s+=Number(t.total_ventas)});const i=s.toFixed(2);document.getElementById("total-gain").textContent="S/ "+i;const d=s-c,l=c>0?(d/c*100).toFixed(2):0,u=document.getElementById("percentage-change");s>c?(u.innerHTML=`<i class="bi bi-arrow-up"></i> ${l}%`,u.classList.add("text-success"),u.classList.remove("text-danger")):s<c?(u.innerHTML=`<i class="bi bi-arrow-down"></i> ${l}%`,u.classList.add("text-danger"),u.classList.remove("text-success")):(u.innerHTML='<i class="bi bi-arrow-right"></i> 0%',u.classList.add("text-secondary"),u.classList.remove("text-success","text-danger"));const m={series:[{name:"Ganancias",data:r},{name:"Compras",data:n}],chart:{type:"bar",height:200},plotOptions:{bar:{horizontal:!1,columnWidth:"55%",endingShape:"rounded"}},colors:["#0d6efd","#dc3545"],dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:a},fill:{opacity:1},tooltip:{y:{formatter:function(t){return"S/ "+Number(t).toFixed(2)}}}},h=new ApexCharts(document.querySelector("#profit-loss-chart"),m);h.render()}).catch(t=>{console.error("Error al obtener los datos:",t)})});