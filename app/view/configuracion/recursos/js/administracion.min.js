function handleResponse(e,t,r=!0){"success"===e.status?Swal.fire({icon:"success",title:"¡Éxito!",text:t||e.message,confirmButtonText:"Aceptar"}).then(()=>{r&&location.reload()}):Swal.fire({icon:"error",title:"Error",text:e.message,confirmButtonText:"Aceptar"})}function sendRequest(e,t,r,o,i=!0){fetch(e,{method:t,body:r}).then(e=>e.json()).then(e=>handleResponse(e,o,i)).catch(e=>{Swal.fire({icon:"error",title:"Error",text:"Ocurrió un error inesperado. Intenta de nuevo.",confirmButtonText:"Aceptar"}),console.error("Error:",e)})}function deshabilitarAdministrador(e){const t=e.getAttribute("data-id"),r=document.getElementById("current-user-id").value;t!==r?Swal.fire({title:"¿Está seguro?",text:"Esta acción deshabilitará al administrador.",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, deshabilitar",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&sendRequest("/gestion/app/controller/AdministradorController.php?action=deshabilitarAdministrador","POST",new URLSearchParams({id:t}),"Administrador deshabilitado exitosamente.")}):Swal.fire({icon:"error",title:"Acción no permitida",text:"No puedes deshabilitar tu propia cuenta.",confirmButtonText:"Aceptar"})}document.getElementById("formCrearAdministrador").addEventListener("submit",function(e){e.preventDefault();const t=new FormData(this);sendRequest("/gestion/app/controller/AdministradorController.php?action=crearAdministrador","POST",t,"Administrador creado exitosamente.")}),document.getElementById("formEditarAdministrador").addEventListener("submit",function(e){e.preventDefault();const t=new FormData(this);sendRequest("/gestion/app/controller/AdministradorController.php?action=editarAdministrador","POST",t,"Administrador editado exitosamente.")}),document.getElementById("correo").addEventListener("blur",function(){const e=this.value;fetch("/gestion/app/controller/AdministradorController.php?action=validarCorreoODni",{method:"POST",body:new URLSearchParams({correo:e})}).then(e=>e.json()).then(e=>{"error"===e.status?(this.setCustomValidity("Este correo ya está registrado."),Swal.fire("Error",e.message,"error")):this.setCustomValidity("")}).catch(e=>console.error("Error:",e))}),document.getElementById("dni").addEventListener("blur",function(){const e=this.value;fetch("/gestion/app/controller/AdministradorController.php?action=validarCorreoODni",{method:"POST",body:new URLSearchParams({dni:e})}).then(e=>e.json()).then(e=>{"error"===e.status?(this.setCustomValidity("Este DNI ya está registrado."),Swal.fire("Error",e.message,"error")):this.setCustomValidity("")}).catch(e=>console.error("Error:",e))}),document.getElementById("editModal").addEventListener("show.bs.modal",function(e){const t=e.relatedTarget,r=this;r.querySelector("#edit-id").value=t.getAttribute("data-id"),r.querySelector("#edit-nombres").value=t.getAttribute("data-nombres"),r.querySelector("#edit-apellidos").value=t.getAttribute("data-apellidos"),r.querySelector("#edit-correo").value=t.getAttribute("data-correo"),r.querySelector("#edit-dni").value=t.getAttribute("data-dni"),r.querySelector("#edit-celular").value=t.getAttribute("data-celular"),r.querySelector("#edit-direccion").value=t.getAttribute("data-direccion"),r.querySelector("#edit-ocupacion").value=t.getAttribute("data-ocupacion")}),document.getElementById("edit-password-old").addEventListener("blur",function(){const e=this.value,t=document.getElementById("edit-id").value;""!==e.trim()&&fetch("/gestion/app/controller/AdministradorController.php?action=validarPassword",{method:"POST",body:new URLSearchParams({id:t,password_old:e})}).then(e=>e.json()).then(e=>{"error"===e.status?(Swal.fire({icon:"error",title:"Error",text:e.message,confirmButtonText:"Aceptar"}),document.getElementById("edit-password-old").setCustomValidity(e.message)):document.getElementById("edit-password-old").setCustomValidity("")}).catch(e=>console.error("Error:",e))});